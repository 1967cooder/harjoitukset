CKEDITOR.plugins.add("uploadinsertimage",{requires:"uploadwidget",init:function(e){e.addCommand("uploadinsertimage",{exec:function(e){var t="a800e2844aa194d049407716de3490f85",i=document.getElementById(t);i?i.innerHTML="":((i=document.createElement("div")).id=t,document.getElementsByTagName("body")[0].appendChild(i));var a=document.createElement("input");a.type="file",a.accept="image/*",a.style="position:fixed;top:-100em;",i.appendChild(a),a.addEventListener("change",function(t){var i=t.target.files[0],a=e.uploadRepository.create(i),n=new CKEDITOR.dom.element("img");n.setAttribute("src","data:image/gif;base64,R0lGODlhDgAOAIAAAAAAAP///yH5BAAAAAAALAAAAAAOAA4AAAIMhI+py+0Po5y02qsKADs=");var d=new FileReader;d.onload=function(e){n.setAttribute("src",e.target.result)},d.readAsDataURL(i),CKEDITOR.fileTools.markElement(n,"uploadimage",a.id),e.insertElement(n),e.widgets.initOn(n,"uploadimage"),a.upload(CKEDITOR.fileTools.getUploadUrl(e.config,"image")),CKEDITOR.fileTools.bindNotifications(e,a)}),a.dispatchEvent(new MouseEvent("click"))}})}});