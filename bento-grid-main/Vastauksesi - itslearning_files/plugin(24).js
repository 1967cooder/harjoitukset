/**
 * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
"use strict";!function(){var e=/^<a[^>]+href="([^"]+)"[^>]*>([^<]+)<\/a>$/i;CKEDITOR.plugins.add("autoembed",{requires:"autolink,undo",lang:"ca,co,da,de,en,en-gb,en-us,es,fi,fr,it,lt,nb,nl,nn-no,pl,pt-br,ru,sv,tr,uk,zh-cn",init:function(t){var a,n=1;t.on("paste",function(i){if(i.data.dataTransfer.getTransferType(t)!=CKEDITOR.DATA_TRANSFER_INTERNAL){var o=i.data.dataValue.match(e);(a=null!=o&&decodeURI(o[1])==decodeURI(o[2]))&&(i.data.dataValue='<a data-cke-autoembed="'+ ++n+'"'+i.data.dataValue.substr(2))}else a=0},null,null,20),t.on("afterPaste",function(){a&&function(e,t){var a=e.editable().findOne('a[data-cke-autoembed="'+t+'"]');e.lang.autoembed;if(!a||!a.data("cke-saved-href"))return;var n=a.data("cke-saved-href"),i=CKEDITOR.plugins.autoEmbed.getWidgetDefinition(e,n);if(!i)return void CKEDITOR.warn("autoembed-no-widget-def");var o,d="function"==typeof i.defaults?i.defaults():i.defaults,r=CKEDITOR.dom.element.createFromHtml(i.template.output(d)),u=e.widgets.wrapElement(r,i.name),f=new CKEDITOR.dom.documentFragment(u.getDocument());if(f.append(u),o=e.widgets.initOn(r,i),!o)return void s();function s(){e.widgets.finalizeCreation(f)}o.loadContent(n,{noNotifications:!0,callback:function(){var a=e.editable().findOne('a[data-cke-autoembed="'+t+'"]');if(a){var n=e.getSelection(),i=e.createRange(),o=e.editable();e.fire("saveSnapshot"),e.fire("lockSnapshot",{dontUpdate:!0});var d=n.createBookmarks(!1)[0],r=d.startNode,f=d.endNode||r;CKEDITOR.env.ie&&CKEDITOR.env.version<9&&!d.endNode&&r.equals(a.getNext())&&a.append(r),i.setStartBefore(a),i.setEndAfter(a),o.insertElement(u,i),o.contains(r)&&o.contains(f)?n.selectBookmarks([d]):(r.remove(),f.remove()),e.fire("unlockSnapshot")}s()},errorCallback:function(){e.widgets.destroy(o,!0)}})}(t,n)})}}),CKEDITOR.plugins.autoEmbed={getWidgetDefinition:function(e,t){var a,n=e.config.autoEmbed_widget||"embed,embedSemantic",i=e.widgets.registered;if("string"==typeof n){for(n=n.split(",");a=n.shift();)if(i[a])return i[a]}else if("function"==typeof n)return i[n(t)];return null}}}();