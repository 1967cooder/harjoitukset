function ViewLearningToolElement(e,n,s){var o,t=this;new CCL.AutoIframeResizer({extensionIframeId:e.controls.extensionIframe,extensionContentId:e.controls.extensionContent,iosScrollFixClass:e.cssClasses.iosScrollFix,resizeIframeWidth:e.resizeExtensionIframeWidth}).init();var a=new ItslearningWeb.Onboarding.ViewLearningToolElement.PostMessageDispatcher;if(d()){var i=$("#"+e.controls.extensionIframe);a.init(e.onboardingServiceUrl,i,e)}CommonFunctions.attachPostMessageEventListener($(window),e.refreshTreeMenuMessageName,function(){var n;(n=window.parent)&&window!=n&&CommonFunctions.makePostMessageCall(n,{messageName:e.refreshTreeMenuMessageName,elementId:e.elementId,folderId:e.folderId})}),CommonFunctions.attachPostMessageEventListener($(window),e.refreshElementFrameMessageName,function(){window.location.reload(!0)}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.openPersonProfileCard,function(e){document.showProfileCard(e.extendedData)}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.backToPreviousPage,function(){document.location.replace(e.backPageUrl)}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.cloudFilePermissionError,function(){window.location.replace(e.cloudFilePermissionErrorUrl)}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.askExtensionParentFrameWhetherTopFrameExists,function(){var e=!1;try{e=window.self!==window.itslTop}catch(e){}var n=d();if(n&&e){var s=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.replyToExtensionFrameWhenTopFrameExists);CCL.CommonFunctions.makePostMessageCall(n,s)}}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.askWhetherItslearningIsEmbedded,function(){var n=d();if(n&&e.isItslearningEmbedded){var s=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.replyIfItslearningIsEmbedded);CCL.CommonFunctions.makePostMessageCall(n,s)}else{var o;(o=window.parent)&&window!==o&&CommonFunctions.makePostMessageCall(o,new CCL.CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.askWhetherItslearningIsEmbedded))}}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.replyIfItslearningIsEmbedded,function(){var e=d();if(e){var n=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.replyIfItslearningIsEmbedded);CCL.CommonFunctions.makePostMessageCall(e,n)}}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.replaceTopFrame,function(e){var n;e&&e.url&&((n=window.parent)&&window!==n?CommonFunctions.makePostMessageCallWithData(n,new CCL.CommonWindowMessages.GenericMessage(CommonWindowMessages.MessageNames.replaceTopFrame),{url:e.url}):window.location.replace(e.url))}),CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.scrollToTop,function(){$(window).scrollTop(0)}),s&&s(),e.canEdit&&e.copyStatus==e.enums.copyStatus.inProgress&&(o=setInterval(m,1e3)),CCL.CommonFunctions.attachPostMessageEventListener($(window),CommonWindowMessages.MessageNames.elementAddedToYourCollection,function(){var n;n=window.location.href.split("#")[0],window.location.href=n.setQueryStringParameter(e.addedParam,(!0).toString())}),CCL.IframeContentHeightReporter.attachExtensionContentOpenedListenerForIframe(e.controls.extensionIframe,e.resizeExtensionIframeWidth),c(e.isActive),t.closeManageRubricDialog=function(){var n=$("#"+e.rubricDialogClientInstanceName).find("iframe").get(0).contentWindow;CCL.CommonFunctions.makePostMessageCall(n,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.submitIframe))},t.showCopyConfirmation=function(n){$.alerts.okButton=n,$.alerts.cancelButton=e.terms.cancel,jConfirm(e.terms.startCopyingConfirmation,e.terms.pleaseConfirm,function(n){n&&CCL.CommonFunctions.safeAjaxPost({url:e.webMethods.startCopying.replace("{elementId}",e.elementId)}).done(function(n){n.success&&(e.isCopy=!1,t.showProgressMessage(e.terms.creatingNewVersionProgressFeedback),o=setInterval(m,1e3))})})},t.showProgressMessage=function(n){$("#"+e.controls.progressPanel).show(),$("#"+e.controls.progressLabel).text(n),r().hide(!1)},t.flushCopyStatus=function(){CCL.CommonFunctions.safeAjaxPost({url:e.webMethods.flushCopyStatus.replace("{elementId}",e.elementId)})},t.printContentFrame=function(n){var s=d();if(s){var o='<h1 css="'+e.cssClasses.title+'" style="margin-bottom:16px;">'+n+"</h1>";CommonFunctions.makePostMessageCall(s,{messageName:CommonWindowMessages.MessageNames.extensionPrintContentFrame,headerText:n,headerHtml:o})}return!1},t.notifyAboutChanges=function(){return $.alerts.okButton=e.terms.ok,$.alerts.cancelButton=e.terms.cancel,jConfirm(e.terms.notifyAboutChangesConfirmation,e.terms.pleaseConfirm,function(n){n&&CCL.CommonFunctions.safeAjaxPost({url:e.webMethods.notifyAboutChanges,data:{elementId:e.elementId}}).fail(CCL.CommonFunctions.alertAjaxError)}),!1},t.sendElementReminders=function(){return $.alerts.okButton=e.terms.sendRemindersYes,$.alerts.cancelButton=e.terms.cancel,jConfirm(e.terms.sendRemindersDetails,e.terms.sendReminders,function(n){n&&CCL.CommonFunctions.safeAjaxPost({url:e.webMethods.sendReminders,data:{elementId:e.elementId}}).fail(CCL.CommonFunctions.alertAjaxError)}),!1};var r=function(){return window[e.copyStatusFeedbackInstanceName]};function m(){CCL.CommonFunctions.safeAjaxPost({url:e.webMethods.checkCopyStatus.replace("{elementId}",e.elementId)}).done(function(n){n.status!=e.enums.copyStatus.inProgress&&(clearInterval(o),$("#"+e.controls.progressPanel).hide(),r().toggleCloseLink(!1),n.status==e.enums.copyStatus.completed?e.isCopy||r().showMessage(e.enums.feedbackType.information,e.terms.creatingNewVersionSucceededFeedback):n.status==e.enums.copyStatus.failed?e.isCopy?r().showMessage(e.enums.feedbackType.warning,e.terms.creatingCopyFailedFeedback):r().showMessage(e.enums.feedbackType.warning,e.terms.creatingNewVersionFailedFeedback):n.status!=e.enums.copyStatus.none||e.isCopy?r().showMessage(e.enums.feedbackType.information,e.terms.copyingStatusChangedFeedback):r().showMessage(e.enums.feedbackType.information,e.terms.creatingNewVersionSucceededFeedback))}).error(function(){clearInterval(o)})}function c(n){var s=$("."+e.cssClasses.pageFunctionDependsFromElementActivation);s&&s.length&&(s.toggleHyperlink(n),s.toggleClass(e.cssClasses.inactive,!n))}function d(){var n=$("#"+e.controls.extensionIframe);return n&&n[0]&&n[0].contentWindow?n[0].contentWindow:null}t.copyToClipboardOk=function(n){var s=null,o=null;"CopyLink"==n?(s=$("#"+e.controls.linkText),o=$("#"+e.controls.copyLinkToClipboardOkIcon)):(s=$("#"+e.controls.embedCodeText),o=$("#"+e.controls.copyEmbedCodeToClipboardOkIcon));var t,a,i=o.css("width");o.parent().css("width",i),t=s.val(),(a=document.createElement("input")).style.position="fixed",a.style.opacity=0,a.value=t,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),o.prev().hide(),o.fadeIn(500),setTimeout(function(){o.hide().prev().fadeIn(400)},1e3)},t.changePageFunctionsState=function(e){c(e)}}