/**
 * @license Copyright (c) CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.html or http://ckeditor.com/license
 */
!function(){if(function(){if("undefined"==typeof Storage)return!1;try{return localStorage.getItem("___test_key"),!0}catch(e){return!1}}()){CKEDITOR.plugins.add("autosave",{version:"0.18.4",init:function(e){e.config.autosave="autosave"in e.config?e.config.autosave:{};var o="saveKeyPrefix"in e.config.autosave?e.config.autosave.saveKeyPrefix:"autosave",n="saveKeyIgnoreProtocol"in e.config.autosave&&e.config.autosave.saveKeyIgnoreProtocol?window.location.href.replace(/https?:\/\//,""):window.location.href,s="saveKeyDelimiter"in e.config.autosave?e.config.autosave.saveKeyDelimiter:"_",r="saveKeyAttribute"in e.config.autosave?e.config.autosave.saveKeyAttribute:"name";"saveKeyIgnoreParams"in e.config.autosave&&CKEDITOR.tools.array.forEach(e.config.autosave.saveKeyIgnoreParams,function(){n=function(e,t,a){a||(a=window.location.href);var o,n=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");if(n.test(a))return null!=t?a.replace(n,"$1"+e+"="+t+"$2$3"):(o=a.split("#"),a=o[0].replace(n,"$1$3").replace(/(&|\?)$/,""),void 0!==o[1]&&null!==o[1]&&(a+="#"+o[1]),a);if(null!=t){var i=-1!==a.indexOf("?")?"&":"?";return o=a.split("#"),a=o[0]+i+e+"="+t,void 0!==o[1]&&null!==o[1]&&(a+="#"+o[1]),a}return a}(this,null,n)});var u={delay:10,messageType:"notification",saveDetectionSelectors:"a[href^='javascript:__doPostBack'],button[id*='Save']",saveOnDestroy:!1,NotOlderThen:1440,SaveKey:o+s+n+s+document.getElementById(e.name).getAttribute(r),diffType:"sideBySide",autoLoad:!1},c=CKEDITOR.tools.extend(u,e.config.autosave||{},!0);e.addCommand("removeAutoSaveStorage",{exec:function(e){i(c.SaveKey,e)}}),e.on("uiSpace",function(e){"bottom"==e.data.space&&null!=c.messageType&&"statusbar"==c.messageType&&(e.data.html+='<div class="autoSaveMessage" unselectable="on"><div unselectable="on" id="'+a(e.editor)+'"class="hidden">'+e.editor.lang.autosave.autoSaveMessage+"</div></div>")},e,null,100),e.on("instanceReady",function(){"function"==typeof requirejs?requirejs([CKEDITOR.getUrl(CKEDITOR.plugins.getPath("autosave")+"js/lz-string.js")],function(){t(e,c)}):CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(CKEDITOR.plugins.getPath("autosave")+"js/lz-string.js"),function(){t(e,c)})},e,null,100),document.addEventListener(c.ClearLocalStorageDataEventName,function(){i(c.SaveKey,e)},!1)}});var e=function(e,t){if(null==t.config.autosave_timeOutId){var a=null!=e.delay?e.delay:10;t.config.autosave_timeOutId=setTimeout(function(){!function(e,t){if(t.checkDirty()||t.plugins.bbcode){var a=t;n(null!=e.SaveKey?e.SaveKey:"autosave_"+window.location+"_"+document.getElementById(a.name).getAttribute("name"),a,e),clearTimeout(t.config.autosave_timeOutId),t.config.autosave_timeOutId=null}}(e,t)},1e3*a)}}}else CKEDITOR.plugins.add("autosave",{});function t(t,a){!function(e,t,a,n){if(localStorage.getItem(a)){var s=(u=o(a)).data,r=u.saveTime;if(e.getData()==s)return void localStorage.removeItem(a);if(Math.floor((new Date-new Date(r))/6e4)>n)return void i(a,e);if(t.autoLoad){if(localStorage.getItem(a)){var u=o(a);e.setData(u.data)}}else CCL.CommonFunctions.jAjaxConfirm(CCL.CommonFunctions.htmlEncode(t.Terms.AutoSaveTextInsertionConfirmation),"",t.Terms.Insert,t.Terms.Cancel,function(t){if(t){if(localStorage.getItem(a)){var n=o(a);e.setData(n.data)}}else i(a,e)})}}(t,a,a.SaveKey,a.NotOlderThen),CKEDITOR.tools.array.forEach(CKEDITOR.document.find(a.saveDetectionSelectors).toArray(),function(e){e.$.addEventListener("click",function(){i(a.SaveKey,t)})}),t.on("change",function(){e(a,t)}),t.on("destroy",function(){a.saveOnDestroy&&n(a.SaveKey,t,a)})}function a(e){return"cke_autoSaveMessage_"+e.name}function o(e){var t=LZString.decompressFromUTF16(localStorage.getItem(e));return JSON.parse(t)}function n(e,t,o){var n=LZString.compressToUTF16(JSON.stringify({data:t.getData(),saveTime:new Date})),i=!1;try{localStorage.setItem(e,n)}catch(e){i=function(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t}(e),i&&console.log("Browser localStorage is full, clear your storage or Increase database size")}if(!i){var s=null!=o.messageType?o.messageType:"notification";if(t.plugins.wordcount&&"statusbar"==s&&t.container.$.clientWidth<150&&(s="notification"),"statusbar"==s){var r=document.getElementById(a(t));r&&(r.className="show",setTimeout(function(){r.className="hidden"},2e3))}else if("notification"==s){new CKEDITOR.plugins.notification(t,{message:t.lang.autosave.autoSaveMessage,type:"success"}).show()}}}function i(e,t){t.config.autosave_timeOutId&&clearTimeout(t.config.autosave_timeOutId),localStorage.removeItem(e)}}();