CKEDITOR.plugins.add("collapsetoolbar",{lang:["ca","co","da","de","en-gb","en-us","es","fi","fr","it","lt","nb","nl","nn-no","pl","pt-br","ru","sv","tr","uk","zh-cn"],init:function(e){var o=e.config.collapsetoolbar.Id,t=e.lang[o],n=e.config.collapsetoolbar.ExtraSettings,i=n&&n.VisibleItemIndices?n.VisibleItemIndices:[0,1],l=n&&n.KpiUrl?n.KpiUrl:void 0,a=n&&n.KpiSection?n.KpiSection:void 0,r=n&&n.KpiMeasurement?n.KpiMeasurement:void 0,c=n&&n.KpiContext?n.KpiContext:void 0;e.addCommand(o,{exec:function(e){var o=e.container.$.querySelector(".cke_toolbox"),n=o.querySelector(".cke_button__collapsetoolbar"),i=n&&n.querySelector(".cke_button__collapsetoolbar_label"),s=!o.classList.contains("ccl-texteditor-toobar-forceexpand");o.classList.toggle("ccl-texteditor-toobar-forceexpand"),i&&(i.innerHTML=s?t.hideOptions:t.moreOptions),n&&n.setAttribute("title",s?t.hideOptionsToolTip:t.moreOptionsToolTip),e.fire("collapsetoolbar.toggle",{expanded:s}),l&&a&&r&&c&&CommonFunctions.measureKpi(l,a,r,c)}}),e.ui.addButton("collapsetoolbar",{label:t.moreOptions,title:t.moreOptionsToolTip,command:o}),e.on("instanceReady",function(){var o=e.container.$.querySelector(".cke_toolbox"),t=o.querySelector(".cke_button__collapsetoolbar");t&&t.parentElement.parentElement.classList.add("ccl-texteditor-collapsetoolbar-section");for(var n=0;n<o.children.length;n++)i.indexOf(n)<0&&o.children[n].classList.add("ccl-texteditor-toobar-hideable");o.style.display="block"})},afterInit:function(e){CommonFunctions.isEdge()&&(window.onerror=function(e,o,t){-1!==o.indexOf("ckeditor.js")&&setTimeout(function(){for(var e in CKEDITOR.instances){var o=CKEDITOR.instances[e];"loaded"===o.status&&(o.status="ready",o.fire("instanceReady",null,o))}"loaded"===CKEDITOR.status&&(CKEDITOR.status="ready",CKEDITOR.fire("instanceReady",null,o))},200)})}});